<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîê FHE Blind Auction - Powered by Zama</title>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Ethers.js v6 CDN -->
    <script src="https://cdn.jsdelivr.net/npm/ethers@6.9.0/dist/ethers.umd.min.js"></script>
    
    <!-- fhevm CDN -->
   <script
  src="https://cdn.zama.ai/relayer-sdk-js/0.2.0/relayer-sdk-js.umd.cjs"
  type="text/javascript"
></script>
    
    <style>
        /* Custom styles */
        body {
            background: linear-gradient(to bottom right, #581c87, #1e3a8a, #312e81);
            min-height: 100vh;
            font-family: system-ui, -apple-system, sans-serif;
        }
        
        .glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .shimmer {
            background: linear-gradient(
                to right,
                transparent 0%,
                rgba(255, 255, 255, 0.1) 50%,
                transparent 100%
            );
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        input:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(96, 165, 250, 0.3);
        }
        
        button:active:not(:disabled) {
            transform: scale(0.98);
        }
        
        /* Hide number input spinners */
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        
        input[type="number"] {
            -moz-appearance: textfield;
        }
        
        .status-message {
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body class="text-white">
    <div id="app" class="container mx-auto px-4 py-8 max-w-6xl">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-5xl font-bold mb-2 bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-purple-400">
                üîê FHE Blind Auction
            </h1>
            <p class="text-blue-200 text-lg">Fully Homomorphic Encrypted Bidding on Ethereum</p>
            <p class="text-sm text-gray-400 mt-2">Powered by Zama FHEVM</p>
        </div>

        <!-- Loading Screen -->
        <div id="loading-screen" class="glass rounded-2xl p-8 text-center">
            <div class="animate-pulse">
                <div class="w-20 h-20 bg-gradient-to-br from-blue-500 to-purple-500 rounded-full mx-auto flex items-center justify-center text-4xl mb-4">
                    üîê
                </div>
                <h2 class="text-2xl font-bold mb-2">Initializing...</h2>
                <p class="text-gray-300">Loading Web3 libraries and FHEVM SDK</p>
            </div>
        </div>

        <!-- Main App (hidden initially) -->
        <div id="main-app" style="display: none;">
            <!-- Connect Wallet Section -->
            <div id="connect-section" class="glass rounded-2xl p-8 text-center max-w-md mx-auto">
                <div class="mb-6">
                    <div class="w-20 h-20 bg-gradient-to-br from-blue-500 to-purple-500 rounded-full mx-auto flex items-center justify-center text-4xl mb-4">
                        üîê
                    </div>
                    <h2 class="text-2xl font-bold mb-2">Connect Your Wallet</h2>
                    <p class="text-gray-300">Connect to Sepolia testnet to participate in the auction</p>
                </div>
                <button
                    id="connect-btn"
                    class="w-full bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 text-white font-bold py-4 px-6 rounded-xl transition-all transform hover:scale-105"
                >
                    Connect MetaMask
                </button>
            </div>

            <!-- Auction Interface (hidden initially) -->
            <div id="auction-interface" style="display: none;">
                <!-- Account Info -->
                <div class="glass rounded-xl p-4 mb-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-400">Connected Account</p>
                            <p id="account-address" class="font-mono text-sm"></p>
                        </div>
                        <div class="text-right">
                            <p class="text-sm text-gray-400">Contract</p>
                            <a 
                                href="https://sepolia.etherscan.io/address/0xf885102a2ac3ef23744defb89ce71ad2b458e0ab"
                                target="_blank"
                                class="font-mono text-sm text-blue-400 hover:text-blue-300"
                            >
                                0xf885...58e0ab
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Auction Info Grid -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <!-- Round Info -->
                    <div class="glass rounded-xl p-6">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-gray-400">Round</span>
                            <span id="auction-state" class="px-3 py-1 rounded-full text-xs font-bold"></span>
                        </div>
                        <p id="auction-round" class="text-3xl font-bold">#-</p>
                    </div>

                    <!-- Time Remaining -->
                    <div class="glass rounded-xl p-6">
                        <p class="text-gray-400 mb-2">Time Remaining</p>
                        <p id="time-remaining" class="text-2xl font-bold">Loading...</p>
                        <p id="end-time" class="text-xs text-gray-400 mt-1"></p>
                    </div>

                    <!-- Bidders -->
                    <div class="glass rounded-xl p-6">
                        <p class="text-gray-400 mb-2">Active Bidders</p>
                        <p id="bidders-count" class="text-3xl font-bold">-</p>
                        <p class="text-sm text-gray-400 mt-1">out of 50 max</p>
                    </div>
                </div>

                <!-- Main Content Grid -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Bid Form -->
                    <div class="lg:col-span-2 glass rounded-xl p-6">
                        <h2 class="text-2xl font-bold mb-6 flex items-center">
                            <span class="text-2xl mr-2">üéØ</span>
                            Place Encrypted Bid
                        </h2>

                        <div class="space-y-4">
                            <!-- Bid Amount -->
                            <div>
                                <label class="block text-sm font-medium mb-2">
                                    Bid Amount (ETH) - Encrypted
                                </label>
                                <input
                                    type="number"
                                    id="bid-amount"
                                    step="0.01"
                                    placeholder="Enter your bid amount"
                                    class="w-full bg-white/5 border border-white/20 rounded-lg px-4 py-3 transition text-white"
                                />
                                <p class="text-xs text-gray-400 mt-1">
                                    ‚ÑπÔ∏è Your bid will be encrypted with FHE - nobody can see it!
                                </p>
                            </div>

                            <!-- Deposit Amount -->
                            <div>
                                <label class="block text-sm font-medium mb-2">
                                    Deposit Amount (ETH)
                                </label>
                                <input
                                    type="number"
                                    id="deposit-amount"
                                    step="0.01"
                                    placeholder="Minimum: 0.01 ETH"
                                    class="w-full bg-white/5 border border-white/20 rounded-lg px-4 py-3 transition text-white"
                                />
                                <p class="text-xs text-gray-400 mt-1">
                                    üí∞ Min deposit: <span id="min-deposit">0.01</span> ETH | Refunded if you don't win
                                </p>
                            </div>

                            <!-- Submit Button -->
                            <button
                                id="submit-bid-btn"
                                class="w-full bg-gradient-to-r from-green-500 to-blue-500 hover:from-green-600 hover:to-blue-600 disabled:from-gray-500 disabled:to-gray-600 text-white font-bold py-4 px-6 rounded-xl transition-all transform hover:scale-105 disabled:scale-100 disabled:cursor-not-allowed"
                            >
                                üîê Submit Encrypted Bid
                            </button>
                        </div>

                        <!-- Status Messages -->
                        <div id="status-container" class="mt-4 space-y-2"></div>
                    </div>

                    <!-- Sidebar -->
                    <div class="space-y-6">
                        <!-- Your Bid Info -->
                        <div id="bidder-info" class="glass rounded-xl p-6">
                            <h3 class="text-lg font-bold mb-4">Your Bid Status</h3>
                            
                            <div class="space-y-3">
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-400">Has Bid:</span>
                                    <span id="has-bidded" class="font-bold">‚ùå No</span>
                                </div>

                                <div class="flex justify-between items-center">
                                    <span class="text-gray-400">Deposit:</span>
                                    <span id="your-deposit" class="font-bold">0 ETH</span>
                                </div>

                                <div class="flex justify-between items-center">
                                    <span class="text-gray-400">Cancelled:</span>
                                    <span id="is-cancelled" class="font-bold">‚ùå No</span>
                                </div>
                            </div>

                            <!-- Cancel Button -->
                            <button
                                id="cancel-bid-btn"
                                style="display: none;"
                                class="w-full mt-4 bg-red-500/20 hover:bg-red-500/30 border border-red-500/50 text-red-200 font-bold py-2 px-4 rounded-lg transition"
                            >
                                Cancel Bid
                            </button>
                        </div>

                        <!-- Pending Refund -->
                        <div id="refund-box" style="display: none;" class="glass rounded-xl p-6 border border-green-500/50">
                            <h3 class="text-lg font-bold mb-3">üí∞ Pending Refund</h3>
                            <p id="refund-amount" class="text-3xl font-bold text-green-400 mb-4">0 ETH</p>
                            <button
                                id="claim-refund-btn"
                                class="w-full bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white font-bold py-3 px-4 rounded-lg transition transform hover:scale-105"
                            >
                                Claim Refund
                            </button>
                        </div>

                        <!-- How It Works -->
                        <div class="glass rounded-xl p-6">
                            <h3 class="text-lg font-bold mb-4">üîê How It Works</h3>
                            <div class="space-y-3 text-sm text-gray-300">
                                <div class="flex items-start">
                                    <span class="mr-2">1Ô∏è‚É£</span>
                                    <span>Your bid is encrypted with FHE before submission</span>
                                </div>
                                <div class="flex items-start">
                                    <span class="mr-2">2Ô∏è‚É£</span>
                                    <span>No one can see your bid amount - not even miners</span>
                                </div>
                                <div class="flex items-start">
                                    <span class="mr-2">3Ô∏è‚É£</span>
                                    <span>Comparisons happen on encrypted data</span>
                                </div>
                                <div class="flex items-start">
                                    <span class="mr-2">4Ô∏è‚É£</span>
                                    <span>Winner determined after decryption by KMS</span>
                                </div>
                                <div class="flex items-start">
                                    <span class="mr-2">5Ô∏è‚É£</span>
                                    <span>2.5% platform fee on winning bid</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Footer -->
                <div class="mt-8 text-center text-sm text-gray-400">
                    <p>Built with ‚ù§Ô∏è using Zama FHEVM | Sepolia Testnet</p>
                    <p class="mt-1">
                        <a 
                            href="https://docs.zama.ai/fhevm" 
                            target="_blank"
                            class="text-blue-400 hover:text-blue-300"
                        >
                            Learn more about FHEVM ‚Üí
                        </a>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Configuration
        const CONTRACT_ADDRESS = "0xf885102a2ac3ef23744defb89ce71ad2b458e0ab";
        const SEPOLIA_CHAIN_ID = 11155111;
        
        const CONTRACT_ABI = [
            "function bid(tuple(bytes32 handle, bytes data) encryptedBid, bytes inputProof, bytes32 publicKey, bytes signature) external payable",
            "function cancelBid() external",
            "function claimRefund() external",
            "function getAuctionInfo() external view returns (uint256 round, uint256 endBlock, uint8 state, uint256 maxDeposit, address leadBidder, uint256 validBidders)",
            "function getBidderInfo(address bidder) external view returns (uint256 deposit, bool hasBidded, bool cancelled)",
            "function getEstimatedEndTime() external view returns (uint256)",
            "function pendingRefunds(address) external view returns (uint256)",
            "function minBidDeposit() external view returns (uint256)"
        ];

        const AUCTION_STATES = {
            0: { name: "Active", color: "text-green-600", bgColor: "bg-green-500" },
            1: { name: "Ended", color: "text-yellow-600", bgColor: "bg-yellow-500" },
            2: { name: "Finalizing", color: "text-blue-600", bgColor: "bg-blue-500" },
            3: { name: "Finalized", color: "text-gray-600", bgColor: "bg-gray-500" },
            4: { name: "Emergency", color: "text-red-600", bgColor: "bg-red-500" }
        };

        // Global state
        let provider = null;
        let signer = null;
        let contract = null;
        let account = null;
        let fhevmInstance = null;
        let refreshInterval = null;

        // Initialize app
        window.addEventListener('load', async () => {
            console.log('üöÄ Initializing FHE Auction DApp...');
            
            // Check if libraries loaded
            if (typeof ethers === 'undefined') {
                showError('Ethers.js failed to load. Please refresh the page.');
                return;
            }
            
            if (typeof fhevm === 'undefined') {
                showError('FHEVM SDK failed to load. Please refresh the page.');
                return;
            }

            // Hide loading screen
            document.getElementById('loading-screen').style.display = 'none';
            document.getElementById('main-app').style.display = 'block';

            // Setup event listeners
            document.getElementById('connect-btn').addEventListener('click', connectWallet);
            document.getElementById('submit-bid-btn').addEventListener('click', submitBid);
            document.getElementById('cancel-bid-btn').addEventListener('click', cancelBid);
            document.getElementById('claim-refund-btn').addEventListener('click', claimRefund);

            console.log('‚úÖ App initialized successfully!');
        });

        // Connect Wallet
        async function connectWallet() {
            try {
                if (!window.ethereum) {
                    showError('Please install MetaMask!');
                    return;
                }

                showStatus('Connecting wallet...', 'blue');

                // Request accounts
                const accounts = await window.ethereum.request({
                    method: 'eth_requestAccounts'
                });

                // Setup provider
                provider = new ethers.BrowserProvider(window.ethereum);
                const network = await provider.getNetwork();

                // Check network
                if (Number(network.chainId) !== SEPOLIA_CHAIN_ID) {
                    try {
                        await window.ethereum.request({
                            method: 'wallet_switchEthereumChain',
                            params: [{ chainId: '0xaa36a7' }] // Sepolia
                        });
                    } catch (switchError) {
                        showError('Please switch to Sepolia testnet in MetaMask');
                        return;
                    }
                }

                // Setup signer and contract
                signer = await provider.getSigner();
                contract = new ethers.Contract(CONTRACT_ADDRESS, CONTRACT_ABI, signer);
                account = accounts[0];

                // Update UI
                document.getElementById('account-address').textContent = 
                    account.slice(0, 6) + '...' + account.slice(-4);
                
                document.getElementById('connect-section').style.display = 'none';
                document.getElementById('auction-interface').style.display = 'block';

                showStatus('‚úÖ Wallet connected!', 'green');
                
                // Initialize FHEVM
                await initializeFHEVM();
                
                // Load auction data
                await loadAuctionData();
                
                // Start auto-refresh
                refreshInterval = setInterval(loadAuctionData, 15000);

            } catch (error) {
                console.error('Connection error:', error);
                showError(error.message || 'Failed to connect wallet');
            }
        }

        // Initialize FHEVM
        async function initializeFHEVM() {
            try {
                showStatus('Initializing FHE encryption system...', 'blue');

                // Get public key from blockchain
                const publicKeyCalldata = "0xd9d47bb001";
                const fheLibAddress = "0x000000000000000000000000000000000000005d";
                
                const publicKeyResult = await provider.call({
                    to: fheLibAddress,
                    data: publicKeyCalldata
                });

                const decodedPublicKey = ethers.AbiCoder.defaultAbiCoder().decode(
                    ["bytes"], 
                    publicKeyResult
                );
                const publicKey = decodedPublicKey[0];

                // Create FHEVM instance
                fhevmInstance = await fhevm.createInstance({
                    chainId: SEPOLIA_CHAIN_ID,
                    publicKey: publicKey
                });

                showStatus('‚úÖ FHE system ready!', 'green');
                
            } catch (error) {
                console.error('FHEVM initialization error:', error);
                showError('Failed to initialize FHE system');
            }
        }

        // Load Auction Data
        async function loadAuctionData() {
            try {
                // Get auction info
                const info = await contract.getAuctionInfo();
                
                // Update round
                document.getElementById('auction-round').textContent = '#' + info[0].toString();
                
                // Update state
                const state = Number(info[2]);
                const stateInfo = AUCTION_STATES[state];
                const stateEl = document.getElementById('auction-state');
                stateEl.textContent = stateInfo.name;
                stateEl.className = `px-3 py-1 rounded-full text-xs font-bold ${stateInfo.bgColor} ${stateInfo.color}`;
                
                // Update bidders
                document.getElementById('bidders-count').textContent = info[5].toString();
                
                // Get estimated end time
                const endTime = await contract.getEstimatedEndTime();
                const endDate = new Date(Number(endTime) * 1000);
                document.getElementById('end-time').textContent = 'Ends: ' + endDate.toLocaleString();
                updateCountdown(endDate);
                
                // Get min deposit
                const minDep = await contract.minBidDeposit();
                document.getElementById('min-deposit').textContent = ethers.formatEther(minDep);
                
                // Get bidder info
                if (account) {
                    const bidInfo = await contract.getBidderInfo(account);
                    
                    document.getElementById('has-bidded').textContent = 
                        bidInfo[1] ? '‚úÖ Yes' : '‚ùå No';
                    document.getElementById('has-bidded').className = 
                        bidInfo[1] ? 'font-bold text-green-400' : 'font-bold text-gray-400';
                    
                    document.getElementById('your-deposit').textContent = 
                        ethers.formatEther(bidInfo[0]) + ' ETH';
                    
                    document.getElementById('is-cancelled').textContent = 
                        bidInfo[2] ? '‚úÖ Yes' : '‚ùå No';
                    document.getElementById('is-cancelled').className = 
                        bidInfo[2] ? 'font-bold text-red-400' : 'font-bold text-green-400';
                    
                    // Show/hide cancel button
                    const cancelBtn = document.getElementById('cancel-bid-btn');
                    if (bidInfo[1] && !bidInfo[2] && state === 0) {
                        cancelBtn.style.display = 'block';
                    } else {
                        cancelBtn.style.display = 'none';
                    }
                    
                    // Get pending refund
                    const refund = await contract.pendingRefunds(account);
                    const refundAmount = ethers.formatEther(refund);
                    if (parseFloat(refundAmount) > 0) {
                        document.getElementById('refund-box').style.display = 'block';
                        document.getElementById('refund-amount').textContent = refundAmount + ' ETH';
                    } else {
                        document.getElementById('refund-box').style.display = 'none';
                    }
                }
                
            } catch (error) {
                console.error('Error loading auction data:', error);
            }
        }

        // Update Countdown
        function updateCountdown(endDate) {
            const now = new Date();
            const diff = endDate - now;
            
            if (diff <= 0) {
                document.getElementById('time-remaining').textContent = 'Auction Ended';
                return;
            }
            
            const hours = Math.floor(diff / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);
            
            document.getElementById('time-remaining').textContent = 
                `${hours}h ${minutes}m ${seconds}s`;
        }

        // Submit Bid
        async function submitBid() {
            const bidAmount = document.getElementById('bid-amount').value;
            const depositAmount = document.getElementById('deposit-amount').value;
            
            if (!bidAmount || !depositAmount) {
                showError('Please fill in all fields');
                return;
            }

            if (!fhevmInstance) {
                showError('FHEVM not initialized. Please refresh and try again.');
                return;
            }

            try {
                const submitBtn = document.getElementById('submit-bid-btn');
                submitBtn.disabled = true;
                submitBtn.textContent = '‚è≥ Processing...';

                showStatus('Preparing bid...', 'blue');

                // Convert to wei
                const bidAmountWei = ethers.parseEther(bidAmount);
                const bidAmountNumber = Number(bidAmountWei);

                showStatus('üîê Encrypting bid with FHE...', 'blue');

                // Create encrypted input
                const input = fhevmInstance.createEncryptedInput(CONTRACT_ADDRESS, account);
                input.add64(BigInt(bidAmountNumber));
                const encryptedData = await input.encrypt();

                showStatus('‚úçÔ∏è Generating EIP-712 signature...', 'blue');

                // Generate EIP-712 signature
                const domain = {
                    name: "FHEAuction",
                    version: "3",
                    chainId: SEPOLIA_CHAIN_ID,
                    verifyingContract: CONTRACT_ADDRESS
                };

                const types = {
                    PublicKey: [{ name: "key", type: "bytes32" }]
                };

                const value = {
                    key: encryptedData.handles[0]
                };

                const signature = await signer.signTypedData(domain, types, value);

                showStatus('üì° Submitting encrypted bid to blockchain...', 'blue');

                // Submit bid
                const depositValue = ethers.parseEther(depositAmount);
                const tx = await contract.bid(
                    {
                        handle: encryptedData.handles[0],
                        data: encryptedData.inputProof
                    },
                    encryptedData.inputProof,
                    encryptedData.handles[0],
                    signature,
                    {
                        value: depositValue,
                        gasLimit: 500000
                    }
                );

                showStatus('‚è≥ Waiting for confirmation...', 'blue');

                const receipt = await tx.wait();
                
                showStatus('‚úÖ Bid placed successfully!', 'green');
                showSuccess(`Transaction: ${receipt.hash.slice(0, 10)}...`);

                // Clear form
                document.getElementById('bid-amount').value = '';
                document.getElementById('deposit-amount').value = '';

                // Reload data
                await loadAuctionData();

                submitBtn.disabled = false;
                submitBtn.textContent = 'üîê Submit Encrypted Bid';

            } catch (error) {
                console.error('Bid error:', error);
                showError(error.message || 'Failed to submit bid');
                
                const submitBtn = document.getElementById('submit-bid-btn');
                submitBtn.disabled = false;
                submitBtn.textContent = 'üîê Submit Encrypted Bid';
            }
        }

        // Cancel Bid
        async function cancelBid() {
            try {
                showStatus('Cancelling bid...', 'blue');
                
                const tx = await contract.cancelBid();
                showStatus('‚è≥ Waiting for confirmation...', 'blue');
                
                const receipt = await tx.wait();
                showStatus('‚úÖ Bid cancelled successfully!', 'green');
                
                await loadAuctionData();
                
            } catch (error) {
                console.error('Cancel error:', error);
                showError(error.message || 'Failed to cancel bid');
            }
        }

        // Claim Refund
        async function claimRefund() {
            try {
                showStatus('Claiming refund...', 'blue');
                
                const tx = await contract.claimRefund();
                showStatus('‚è≥ Waiting for confirmation...', 'blue');
                
                const receipt = await tx.wait();
                showStatus('‚úÖ Refund claimed successfully!', 'green');
                
                await loadAuctionData();
                
            } catch (error) {
                console.error('Claim error:', error);
                showError(error.message || 'Failed to claim refund');
            }
        }

        // UI Helper Functions
        function showStatus(message, type) {
            const container = document.getElementById('status-container');
            const colors = {
                blue: 'bg-blue-500/20 border-blue-500/50 text-blue-200',
                green: 'bg-green-500/20 border-green-500/50 text-green-200',
                red: 'bg-red-500/20 border-red-500/50 text-red-200'
            };
            
            container.innerHTML = `
                <div class="status-message ${colors[type]} border rounded-lg p-3">
                    <p class="text-sm">${message}</p>
                </div>
            `;
        }

        function showError(message) {
            showStatus('‚ùå ' + message, 'red');
        }

        function showSuccess(message) {
            const container = document.getElementById('status-container');
            const successMsg = document.createElement('div');
            successMsg.className = 'status-message bg-green-500/20 border border-green-500/50 rounded-lg p-3';
            successMsg.innerHTML = `<p class="text-sm text-green-200">${message}</p>`;
            container.appendChild(successMsg);
        }

        // Cleanup on page unload
        window.addEventListener('beforeunload', () => {
            if (refreshInterval) {
                clearInterval(refreshInterval);
            }
        });
    </script>
</body>
</html>
